{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Email Classifier System","text":""},{"location":"#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O Email Classifier System \u00e9 uma aplica\u00e7\u00e3o Django para classifica\u00e7\u00e3o autom\u00e1tica de emails como produtivos ou improdutivos utilizando Intelig\u00eancia Artificial. O sistema foi desenvolvido como case para vaga de Engenheiro de Software Jr.</p>"},{"location":"#principais-funcionalidades","title":"Principais Funcionalidades","text":""},{"location":"#classificacao-inteligente","title":"\ud83e\udd16 Classifica\u00e7\u00e3o Inteligente","text":"<ul> <li>Classifica\u00e7\u00e3o autom\u00e1tica usando Google Gemini AI</li> <li>Fallback heur\u00edstico quando a API n\u00e3o est\u00e1 dispon\u00edvel</li> <li>Sistema de confian\u00e7a para classifica\u00e7\u00f5es</li> </ul>"},{"location":"#processamento-de-documentos","title":"\ud83d\udcc4 Processamento de Documentos","text":"<ul> <li>Upload e processamento de arquivos PDF e TXT</li> <li>Extra\u00e7\u00e3o autom\u00e1tica de assunto, conte\u00fado e remetente</li> <li>Suporte a m\u00faltiplos formatos de entrada</li> </ul>"},{"location":"#sistema-de-filas","title":"\ud83d\ude80 Sistema de Filas","text":"<ul> <li>Processamento ass\u00edncrono de emails</li> <li>Sistema de prioridades para jobs</li> <li>Monitoramento de status em tempo real</li> </ul>"},{"location":"#rate-limiting","title":"\u26a1 Rate Limiting","text":"<ul> <li>Controle de requisi\u00e7\u00f5es por minuto e por dia</li> <li>Prote\u00e7\u00e3o contra overuse das APIs</li> <li>Estat\u00edsticas de uso em tempo real</li> </ul>"},{"location":"#api-restful","title":"\ud83c\udf10 API RESTful","text":"<ul> <li>Endpoints para submiss\u00e3o e consulta</li> <li>Suporte a CORS para frontends</li> <li>Documenta\u00e7\u00e3o completa dos endpoints</li> </ul>"},{"location":"#tecnologias-utilizadas","title":"Tecnologias Utilizadas","text":"<ul> <li>Backend: Django 4.2+</li> <li>IA: Google Gemini AI</li> <li>Banco de Dados: SQLite (desenvolvimento)</li> <li>Upload: PDF/TXT processing</li> <li>Documenta\u00e7\u00e3o: MkDocs Material</li> </ul>"},{"location":"#estrutura-do-projeto","title":"Estrutura do Projeto","text":"<pre><code>server/\n\u251c\u2500\u2500 classifier/           # App principal\n\u2502   \u251c\u2500\u2500 models.py        # Modelos de dados\n\u2502   \u251c\u2500\u2500 views.py         # Views e APIs\n\u2502   \u251c\u2500\u2500 ai_service.py    # Servi\u00e7os de IA\n\u2502   \u251c\u2500\u2500 job_queue.py     # Sistema de filas\n\u2502   \u2514\u2500\u2500 rate_limiter.py  # Rate limiting\n\u251c\u2500\u2500 email_classifier/    # Configura\u00e7\u00f5es Django\n\u2514\u2500\u2500 requirements.txt     # Depend\u00eancias\n</code></pre>"},{"location":"#primeiros-passos","title":"Primeiros Passos","text":"<ol> <li>Instala\u00e7\u00e3o: Consulte o Guia de Instala\u00e7\u00e3o</li> <li>Configura\u00e7\u00e3o: Configure as Vari\u00e1veis de Ambiente</li> <li>Arquitetura: Entenda a Vis\u00e3o Geral</li> <li>APIs: Explore os Endpoints Dispon\u00edveis</li> </ol>"},{"location":"mkdocs-commands/","title":"Comandos MkDocs","text":""},{"location":"mkdocs-commands/#instalacao-e-configuracao","title":"Instala\u00e7\u00e3o e Configura\u00e7\u00e3o","text":""},{"location":"mkdocs-commands/#instalar-mkdocs","title":"Instalar MkDocs","text":"<pre><code>cd server\npip install -r requirements.txt\n</code></pre>"},{"location":"mkdocs-commands/#verificar-instalacao","title":"Verificar Instala\u00e7\u00e3o","text":"<pre><code>mkdocs --version\n</code></pre>"},{"location":"mkdocs-commands/#desenvolvimento-da-documentacao","title":"Desenvolvimento da Documenta\u00e7\u00e3o","text":""},{"location":"mkdocs-commands/#iniciar-servidor-de-desenvolvimento","title":"Iniciar Servidor de Desenvolvimento","text":"<pre><code># Na raiz do projeto (onde est\u00e1 mkdocs.yml)\nmkdocs serve\n\n# Servidor rodar\u00e1 em http://127.0.0.1:8000\n</code></pre>"},{"location":"mkdocs-commands/#opcoes-do-servidor","title":"Op\u00e7\u00f5es do Servidor","text":"<pre><code># Porta espec\u00edfica\nmkdocs serve --dev-addr=127.0.0.1:8080\n\n# Modo verboso\nmkdocs serve --verbose\n\n# Hot reload autom\u00e1tico\nmkdocs serve --livereload\n</code></pre>"},{"location":"mkdocs-commands/#build-e-deploy","title":"Build e Deploy","text":""},{"location":"mkdocs-commands/#gerar-site-estatico","title":"Gerar Site Est\u00e1tico","text":"<pre><code>mkdocs build\n</code></pre>"},{"location":"mkdocs-commands/#build-com-limpeza","title":"Build com Limpeza","text":"<pre><code>mkdocs build --clean\n</code></pre>"},{"location":"mkdocs-commands/#deploy-no-github-pages","title":"Deploy no GitHub Pages","text":"<pre><code>mkdocs gh-deploy\n</code></pre>"},{"location":"mkdocs-commands/#deploy-com-branch-especifica","title":"Deploy com Branch Espec\u00edfica","text":"<pre><code>mkdocs gh-deploy --remote-branch=gh-pages\n</code></pre>"},{"location":"mkdocs-commands/#estrutura-de-arquivos","title":"Estrutura de Arquivos","text":""},{"location":"mkdocs-commands/#estrutura-recomendada","title":"Estrutura Recomendada","text":"<pre><code>projeto/\n\u251c\u2500\u2500 mkdocs.yml              # Configura\u00e7\u00e3o principal\n\u251c\u2500\u2500 docs/                   # Documentos fonte\n\u2502   \u251c\u2500\u2500 index.md           # P\u00e1gina inicial\n\u2502   \u251c\u2500\u2500 architecture/      # Arquitetura\n\u2502   \u2502   \u251c\u2500\u2500 overview.md\n\u2502   \u2502   \u251c\u2500\u2500 models.md\n\u2502   \u2502   \u2514\u2500\u2500 apis.md\n\u2502   \u251c\u2500\u2500 features/          # Funcionalidades\n\u2502   \u2502   \u251c\u2500\u2500 classification.md\n\u2502   \u2502   \u251c\u2500\u2500 job-queue.md\n\u2502   \u2502   \u251c\u2500\u2500 rate-limiting.md\n\u2502   \u2502   \u2514\u2500\u2500 file-upload.md\n\u2502   \u2514\u2500\u2500 setup/            # Configura\u00e7\u00e3o\n\u2502       \u251c\u2500\u2500 environment.md\n\u2502       \u251c\u2500\u2500 installation.md\n\u2502       \u2514\u2500\u2500 deployment.md\n\u2514\u2500\u2500 site/                 # Site gerado (n\u00e3o versionado)\n</code></pre>"},{"location":"mkdocs-commands/#validacao-e-testes","title":"Valida\u00e7\u00e3o e Testes","text":""},{"location":"mkdocs-commands/#verificar-links","title":"Verificar Links","text":"<pre><code># Plugin para verificar links quebrados\npip install mkdocs-linkcheck\n\n# Adicionar ao mkdocs.yml:\n# plugins:\n#   - linkcheck\n</code></pre>"},{"location":"mkdocs-commands/#validar-configuracao","title":"Validar Configura\u00e7\u00e3o","text":"<pre><code>mkdocs config\n</code></pre>"},{"location":"mkdocs-commands/#build-de-teste","title":"Build de Teste","text":"<pre><code>mkdocs build --strict\n</code></pre>"},{"location":"mkdocs-commands/#personalizacao","title":"Personaliza\u00e7\u00e3o","text":""},{"location":"mkdocs-commands/#adicionar-plugins","title":"Adicionar Plugins","text":"<pre><code># mkdocs.yml\nplugins:\n  - search\n  - awesome-pages\n  - macros\n</code></pre>"},{"location":"mkdocs-commands/#temas-populares","title":"Temas Populares","text":"<pre><code># Material Theme\ntheme:\n  name: material\n\n# ReadTheDocs Theme\ntheme:\n  name: readthedocs\n\n# Bootswatch Themes\ntheme:\n  name: bootstrap\n  bootstrap_version: 4\n</code></pre>"},{"location":"mkdocs-commands/#extensoes-markdown","title":"Extens\u00f5es Markdown","text":"<pre><code>markdown_extensions:\n  - codehilite\n  - admonition\n  - toc:\n      permalink: true\n  - pymdownx.highlight\n  - pymdownx.superfences\n  - pymdownx.tabbed\n</code></pre>"},{"location":"mkdocs-commands/#automatizacao","title":"Automatiza\u00e7\u00e3o","text":""},{"location":"mkdocs-commands/#github-actions-para-deploy","title":"GitHub Actions para Deploy","text":"<pre><code># .github/workflows/docs.yml\nname: Deploy Documentation\non:\n  push:\n    branches: [ main ]\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/setup-python@v2\n      with:\n        python-version: 3.x\n    - run: pip install mkdocs-material\n    - run: mkdocs gh-deploy --force\n</code></pre>"},{"location":"mkdocs-commands/#script-de-deploy-local","title":"Script de Deploy Local","text":"<pre><code>#!/bin/bash\n# deploy-docs.sh\necho \"Building documentation...\"\nmkdocs build --clean\n\necho \"Deploying to GitHub Pages...\"\nmkdocs gh-deploy\n\necho \"Documentation deployed successfully!\"\n</code></pre>"},{"location":"mkdocs-commands/#dicas-de-uso","title":"Dicas de Uso","text":""},{"location":"mkdocs-commands/#live-reload","title":"Live Reload","text":"<ul> <li>O servidor detecta mudan\u00e7as automaticamente</li> <li>Recarrega a p\u00e1gina no navegador</li> <li>Funciona para arquivos .md e mkdocs.yml</li> </ul>"},{"location":"mkdocs-commands/#navegacao","title":"Navega\u00e7\u00e3o","text":"<ul> <li>Use <code>nav</code> no mkdocs.yml para estruturar</li> <li>Arquivos n\u00e3o listados aparecem alfabeticamente</li> <li>Suporte a subse\u00e7\u00f5es ilimitadas</li> </ul>"},{"location":"mkdocs-commands/#links-internos","title":"Links Internos","text":"<pre><code># Links relativos funcionam\n[Instala\u00e7\u00e3o](setup/installation.md)\n[API Status](../api/status.md)\n\n# \u00c2ncoras em p\u00e1ginas\n[Se\u00e7\u00e3o espec\u00edfica](page.md#secao)\n</code></pre>"},{"location":"mkdocs-commands/#imagens-e-assets","title":"Imagens e Assets","text":"<pre><code># Pasta images/ dentro de docs/\n![Diagrama](images/architecture.png)\n\n# CSS e JS customizados\n# Adicionar em mkdocs.yml:\n# extra_css:\n#   - css/custom.css\n</code></pre>"},{"location":"mkdocs-commands/#troubleshooting","title":"Troubleshooting","text":""},{"location":"mkdocs-commands/#problemas-comuns","title":"Problemas Comuns","text":""},{"location":"mkdocs-commands/#erro-de-build","title":"Erro de Build","text":"<pre><code># Verificar sintaxe YAML\npython -c \"import yaml; yaml.safe_load(open('mkdocs.yml'))\"\n\n# Build verboso\nmkdocs build --verbose\n</code></pre>"},{"location":"mkdocs-commands/#links-quebrados","title":"Links Quebrados","text":"<pre><code># Verificar paths relativos\n# Usar caminhos a partir da pasta docs/\n</code></pre>"},{"location":"mkdocs-commands/#tema-nao-carrega","title":"Tema N\u00e3o Carrega","text":"<pre><code># Verificar instala\u00e7\u00e3o do tema\npip list | grep mkdocs\n\n# Reinstalar tema\npip install --upgrade mkdocs-material\n</code></pre>"},{"location":"mkdocs-commands/#github-pages-nao-atualiza","title":"GitHub Pages N\u00e3o Atualiza","text":"<pre><code># For\u00e7ar deploy\nmkdocs gh-deploy --force\n\n# Verificar configura\u00e7\u00e3o do reposit\u00f3rio\n# Settings &gt; Pages &gt; Source: gh-pages branch\n</code></pre>"},{"location":"architecture/apis/","title":"APIs e Endpoints","text":""},{"location":"architecture/apis/#endpoints-disponiveis","title":"Endpoints Dispon\u00edveis","text":""},{"location":"architecture/apis/#web-interface","title":"Web Interface","text":"Endpoint M\u00e9todo Descri\u00e7\u00e3o <code>/</code> GET/POST P\u00e1gina inicial com formul\u00e1rio <code>/emails/</code> GET Lista de emails classificados <code>/emails/&lt;id&gt;/</code> GET Detalhes de um email <code>/about/</code> GET Sobre o projeto"},{"location":"architecture/apis/#rest-api","title":"REST API","text":"Endpoint M\u00e9todo Descri\u00e7\u00e3o <code>/api/status/</code> GET Status da API <code>/api/submit-email/</code> POST Submeter email para classifica\u00e7\u00e3o <code>/api/emails/</code> GET Lista emails em JSON <code>/api/emails/&lt;id&gt;/</code> GET Detalhes de email em JSON <code>/api/usage/</code> GET Estat\u00edsticas de uso <code>/api/jobs/&lt;job_id&gt;/</code> GET Status de job espec\u00edfico"},{"location":"architecture/apis/#detalhes-dos-endpoints","title":"Detalhes dos Endpoints","text":""},{"location":"architecture/apis/#post-apisubmit-email","title":"POST /api/submit-email/","text":"<p>Submete um email para classifica\u00e7\u00e3o ass\u00edncrona.</p>"},{"location":"architecture/apis/#request","title":"Request","text":"<pre><code>{\n  \"input_method\": \"text|file\",\n  \"subject\": \"Assunto do email\",\n  \"content\": \"Conte\u00fado do email\",\n  \"sender\": \"user@example.com\",\n  \"file\": \"&lt;arquivo em base64&gt;\",\n  \"use_file_subject\": true,\n  \"use_file_sender\": true\n}\n</code></pre>"},{"location":"architecture/apis/#response-sucesso","title":"Response (Sucesso)","text":"<pre><code>{\n  \"status\": \"queued\",\n  \"message\": \"Email submetido para processamento\",\n  \"id\": 123,\n  \"job_id\": \"uuid-do-job\",\n  \"queue_position\": 2,\n  \"estimated_wait\": 6,\n  \"queue_status\": {\n    \"queue_length\": 2,\n    \"estimated_wait\": 6,\n    \"processing_count\": 1\n  }\n}\n</code></pre>"},{"location":"architecture/apis/#response-erro","title":"Response (Erro)","text":"<pre><code>{\n  \"status\": \"error\",\n  \"message\": \"Descri\u00e7\u00e3o do erro\",\n  \"errors\": {\"field\": [\"erro espec\u00edfico\"]}\n}\n</code></pre>"},{"location":"architecture/apis/#get-apijobsjob_id","title":"GET /api/jobs/{job_id}/","text":"<p>Verifica o status de processamento de um job.</p>"},{"location":"architecture/apis/#response-processando","title":"Response (Processando)","text":"<pre><code>{\n  \"id\": \"uuid-do-job\",\n  \"job_type\": \"process_email_complete\",\n  \"status\": \"processing\",\n  \"created_at\": \"2023-12-01T10:00:00Z\",\n  \"started_at\": \"2023-12-01T10:00:05Z\",\n  \"position_in_queue\": 0,\n  \"estimated_wait_time\": 0\n}\n</code></pre>"},{"location":"architecture/apis/#response-concluido","title":"Response (Conclu\u00eddo)","text":"<pre><code>{\n  \"id\": \"uuid-do-job\",\n  \"job_type\": \"process_email_complete\",\n  \"status\": \"completed\",\n  \"created_at\": \"2023-12-01T10:00:00Z\",\n  \"started_at\": \"2023-12-01T10:00:05Z\",\n  \"completed_at\": \"2023-12-01T10:00:08Z\",\n  \"processing_time\": 3.2,\n  \"email\": {\n    \"id\": 123,\n    \"subject\": \"Assunto do email\",\n    \"category\": \"productive\",\n    \"confidence_score\": 85.5,\n    \"is_processed\": true\n  }\n}\n</code></pre>"},{"location":"architecture/apis/#get-apiusage","title":"GET /api/usage/","text":"<p>Obt\u00e9m estat\u00edsticas de uso das APIs.</p>"},{"location":"architecture/apis/#response","title":"Response","text":"<pre><code>{\n  \"gemini_api\": {\n    \"minute_usage\": 5,\n    \"minute_limit\": 20,\n    \"minute_percent\": 25.0,\n    \"day_usage\": 150,\n    \"day_limit\": 15000,\n    \"day_percent\": 1.0,\n    \"total_today\": 150\n  },\n  \"job_queue\": {\n    \"queue_length\": 2,\n    \"estimated_wait\": 6,\n    \"processing_count\": 1,\n    \"queued_jobs\": [...]\n  },\n  \"timestamp\": \"2023-12-01T10:30:00Z\"\n}\n</code></pre>"},{"location":"architecture/apis/#get-apiemailsid","title":"GET /api/emails/{id}/","text":"<p>Obt\u00e9m detalhes de um email espec\u00edfico.</p>"},{"location":"architecture/apis/#response_1","title":"Response","text":"<pre><code>{\n  \"id\": 123,\n  \"subject\": \"Reuni\u00e3o de alinhamento do projeto\",\n  \"content\": \"Gostaria de agendar uma reuni\u00e3o...\",\n  \"sender\": \"manager@empresa.com\",\n  \"category\": \"productive\",\n  \"suggested_response\": \"Prezado(a),\\n\\nAgrade\u00e7o pelo convite...\",\n  \"created_at\": \"2023-12-01T10:00:00.000Z\",\n  \"confidence_score\": 85.5\n}\n</code></pre>"},{"location":"architecture/apis/#cors-configuration","title":"CORS Configuration","text":"<p>O sistema est\u00e1 configurado para aceitar requisi\u00e7\u00f5es cross-origin:</p> <ul> <li>Access-Control-Allow-Origin: <code>*</code> (desenvolvimento)</li> <li>Access-Control-Allow-Methods: GET, POST, OPTIONS</li> <li>Access-Control-Allow-Headers: Content-Type, X-Requested-With</li> </ul>"},{"location":"architecture/apis/#rate-limiting","title":"Rate Limiting","text":"<p>As APIs respeitam os seguintes limites:</p> <ul> <li>Gemini API: 20 req/min, 15000 req/dia</li> <li>Rate limiting: Implementado via middleware personalizado</li> <li>Fallback: Sistema heur\u00edstico quando limites s\u00e3o atingidos</li> </ul>"},{"location":"architecture/models/","title":"Modelos de Dados","text":""},{"location":"architecture/models/#model-email","title":"Model Email","text":"<p>O modelo principal do sistema que representa um email e sua classifica\u00e7\u00e3o.</p>"},{"location":"architecture/models/#campos","title":"Campos","text":"Campo Tipo Descri\u00e7\u00e3o <code>id</code> BigAutoField Chave prim\u00e1ria <code>subject</code> CharField(200) Assunto do email <code>content</code> TextField Conte\u00fado completo do email <code>sender</code> EmailField Email do remetente <code>file</code> FileField Arquivo enviado (opcional) <code>file_type</code> CharField(10) Tipo do arquivo (pdf, txt) <code>category</code> CharField(20) Categoria: 'productive' ou 'unproductive' <code>suggested_response</code> TextField Resposta sugerida pela IA <code>created_at</code> DateTimeField Data/hora de cria\u00e7\u00e3o <code>confidence_score</code> FloatField N\u00edvel de confian\u00e7a (0-100) <code>classification_method</code> CharField(20) M\u00e9todo usado: 'gemini' ou 'heuristic'"},{"location":"architecture/models/#choices","title":"Choices","text":""},{"location":"architecture/models/#category","title":"Category","text":"<ul> <li><code>productive</code>: Emails que requerem a\u00e7\u00e3o, cont\u00eam problemas, perguntas, solicita\u00e7\u00f5es</li> <li><code>unproductive</code>: Emails de parab\u00e9ns, agradecimentos, newsletters, convites</li> </ul>"},{"location":"architecture/models/#metodos","title":"M\u00e9todos","text":""},{"location":"architecture/models/#category_display","title":"<code>category_display</code>","text":"<pre><code>@property\ndef category_display(self):\n    \"\"\"Retorna o valor de exibi\u00e7\u00e3o da categoria\"\"\"\n    return dict(self._meta.get_field('category').choices).get(self.category, self.category)\n</code></pre>"},{"location":"architecture/models/#is_productive","title":"<code>is_productive</code>","text":"<pre><code>@property\ndef is_productive(self):\n    return self.category == 'productive'\n</code></pre>"},{"location":"architecture/models/#indices-de-banco","title":"\u00cdndices de Banco","text":"<p>Para otimiza\u00e7\u00e3o de consultas: - <code>category</code>: Filtros por categoria - <code>created_at</code>: Ordena\u00e7\u00e3o cronol\u00f3gica - <code>sender</code>: Busca por remetente</p>"},{"location":"architecture/models/#upload-de-arquivos","title":"Upload de Arquivos","text":""},{"location":"architecture/models/#funcao-get_upload_path","title":"Fun\u00e7\u00e3o <code>get_upload_path</code>","text":"<pre><code>def get_upload_path(instance, filename):\n    \"\"\"Define o caminho para upload de arquivos de email\"\"\"\n    ext = filename.split('.')[-1]\n    subject_slug = slugify(instance.subject[:30])\n    timestamp = datetime.now().strftime(\"%Y%m%d%H%M%S\")\n    return f'uploads/{instance.sender.split(\"@\")[0]}_{subject_slug}_{timestamp}.{ext}'\n</code></pre> <p>Formato do path: <code>uploads/{username}_{subject-slug}_{timestamp}.{ext}</code></p>"},{"location":"architecture/models/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li><code>subject</code>: M\u00e1ximo 200 caracteres</li> <li><code>sender</code>: Deve ser um email v\u00e1lido</li> <li><code>file_type</code>: Apenas 'pdf' ou 'txt' permitidos</li> <li><code>confidence_score</code>: Valor entre 0.0 e 100.0</li> </ul>"},{"location":"architecture/models/#meta-options","title":"Meta Options","text":"<pre><code>class Meta:\n    verbose_name = 'Email'\n    verbose_name_plural = 'Emails'\n    ordering = ['-created_at']  # Mais recentes primeiro\n</code></pre>"},{"location":"architecture/overview/","title":"Vis\u00e3o Geral da Arquitetura","text":""},{"location":"architecture/overview/#estrutura-do-sistema","title":"Estrutura do Sistema","text":"<p>O Email Classifier System segue uma arquitetura baseada em Django com processamento ass\u00edncrono e integra\u00e7\u00e3o com APIs de IA.</p>"},{"location":"architecture/overview/#componentes-principais","title":"Componentes Principais","text":""},{"location":"architecture/overview/#1-camada-de-apresentacao","title":"1. Camada de Apresenta\u00e7\u00e3o","text":"<ul> <li>Views Django: Renderiza\u00e7\u00e3o de templates e APIs REST</li> <li>Templates: Interface web para submiss\u00e3o e visualiza\u00e7\u00e3o</li> <li>CORS Middleware: Suporte a requisi\u00e7\u00f5es cross-origin</li> </ul>"},{"location":"architecture/overview/#2-camada-de-negocio","title":"2. Camada de Neg\u00f3cio","text":"<ul> <li>AI Service: Integra\u00e7\u00e3o com Google Gemini AI</li> <li>Job Queue: Sistema de filas para processamento ass\u00edncrono</li> <li>Rate Limiter: Controle de uso de APIs externas</li> <li>Utils: Processamento de arquivos PDF/TXT</li> </ul>"},{"location":"architecture/overview/#3-camada-de-dados","title":"3. Camada de Dados","text":"<ul> <li>Models Django: Email, com campos de classifica\u00e7\u00e3o</li> <li>SQLite: Banco de dados para desenvolvimento</li> <li>File Storage: Upload e armazenamento de arquivos</li> </ul>"},{"location":"architecture/overview/#fluxo-de-processamento","title":"Fluxo de Processamento","text":""},{"location":"architecture/overview/#processamento-assincrono-recomendado","title":"Processamento Ass\u00edncrono (Recomendado)","text":""},{"location":"architecture/overview/#padroes-arquiteturais","title":"Padr\u00f5es Arquiteturais","text":""},{"location":"architecture/overview/#singleton-pattern","title":"Singleton Pattern","text":"<ul> <li>JobQueue: Inst\u00e2ncia \u00fanica para toda a aplica\u00e7\u00e3o</li> <li>RateLimiter: Controle centralizado de rate limiting</li> </ul>"},{"location":"architecture/overview/#factory-pattern","title":"Factory Pattern","text":"<ul> <li>Job Creation: Cria\u00e7\u00e3o de jobs baseada em tipos registrados</li> <li>Handler Registration: Registro din\u00e2mico de manipuladores</li> </ul>"},{"location":"architecture/overview/#observer-pattern","title":"Observer Pattern","text":"<ul> <li>Job Callbacks: Notifica\u00e7\u00f5es quando jobs s\u00e3o conclu\u00eddos</li> <li>Status Updates: Atualiza\u00e7\u00f5es autom\u00e1ticas de status</li> </ul>"},{"location":"architecture/overview/#configuracoes-de-ambiente","title":"Configura\u00e7\u00f5es de Ambiente","text":"<p>O sistema utiliza vari\u00e1veis de ambiente para configura\u00e7\u00e3o:</p> <ul> <li><code>GEMINI_API_KEY</code>: Chave da API do Google Gemini</li> <li><code>DEBUG</code>: Modo de debug do Django</li> <li><code>SECRET_KEY</code>: Chave secreta do Django</li> <li><code>ALLOWED_HOSTS</code>: Hosts permitidos</li> </ul>"},{"location":"features/classification/","title":"Sistema de Classifica\u00e7\u00e3o de Emails","text":""},{"location":"features/classification/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O sistema classifica emails em duas categorias principais usando IA e fallback heur\u00edstico.</p>"},{"location":"features/classification/#categorias","title":"Categorias","text":""},{"location":"features/classification/#productive-produtivo","title":"Productive (Produtivo)","text":"<p>Emails que requerem a\u00e7\u00e3o ou aten\u00e7\u00e3o: - Problemas t\u00e9cnicos e solicita\u00e7\u00f5es de suporte - Reuni\u00f5es e agendamentos - Projetos e atualiza\u00e7\u00f5es de status - Perguntas e solicita\u00e7\u00f5es - Quest\u00f5es relacionadas ao trabalho</p>"},{"location":"features/classification/#unproductive-improdutivo","title":"Unproductive (Improdutivo)","text":"<p>Emails informativos ou sociais: - Parab\u00e9ns e felicita\u00e7\u00f5es - Agradecimentos e elogios - Newsletters e informativos - Convites sociais - Feedback positivo</p>"},{"location":"features/classification/#metodos-de-classificacao","title":"M\u00e9todos de Classifica\u00e7\u00e3o","text":""},{"location":"features/classification/#1-google-gemini-ai-primario","title":"1. Google Gemini AI (Prim\u00e1rio)","text":""},{"location":"features/classification/#modelo-utilizado","title":"Modelo Utilizado","text":"<ul> <li>Modelo: <code>gemini-1.5-flash</code></li> <li>Configura\u00e7\u00e3o: Temperature 0.7, Top-p 0.95</li> </ul>"},{"location":"features/classification/#prompt-de-classificacao","title":"Prompt de Classifica\u00e7\u00e3o","text":"<pre><code>prompt = f\"\"\"\nAnalise o seguinte email e classifique-o como:\n- 'productive' (emails que requerem a\u00e7\u00e3o, cont\u00eam problemas, perguntas, solicita\u00e7\u00f5es, quest\u00f5es t\u00e9cnicas ou assuntos relacionados ao trabalho)\n- 'unproductive' (emails de parab\u00e9ns, notas de agradecimento, boletins informativos, convites, elogios)\n\nEmail para analisar:\n{full_content}\n\nRegras para classifica\u00e7\u00e3o:\n- Emails sobre reuni\u00f5es, agendamentos ou disponibilidade devem sempre ser classificados como 'productive'\n- Emails com problemas t\u00e9cnicos, solicita\u00e7\u00f5es de suporte ou perguntas s\u00e3o 'productive'\n- Emails contendo principalmente elogios, parab\u00e9ns ou conte\u00fado social s\u00e3o 'unproductive'\n- Em caso de d\u00favida, incline-se para a classifica\u00e7\u00e3o 'productive'\n\nResponda APENAS com \"productive\" ou \"unproductive\" e inclua um valor de confian\u00e7a de 0-100.\nFormato: \"classifica\u00e7\u00e3o|valor_confian\u00e7a\"\n\"\"\"\n</code></pre>"},{"location":"features/classification/#2-sistema-heuristico-fallback","title":"2. Sistema Heur\u00edstico (Fallback)","text":"<p>Usado quando a API Gemini n\u00e3o est\u00e1 dispon\u00edvel ou rate limit \u00e9 atingido.</p>"},{"location":"features/classification/#palavras-chave-improdutivas","title":"Palavras-chave Improdutivas","text":"<pre><code>improdutivo_keywords = [\n    \"parab\u00e9ns\", \"feliz\", \"anivers\u00e1rio\", \"congratula\u00e7\u00f5es\",\n    \"agradecimento\", \"obrigado\", \"newsletter\", \"informativo\",\n    \"convite\", \"festa\", \"celebra\u00e7\u00e3o\", \"elogio\", \"satisfa\u00e7\u00e3o\"\n]\n</code></pre>"},{"location":"features/classification/#palavras-chave-produtivas","title":"Palavras-chave Produtivas","text":"<pre><code>produtivo_keywords = [\n    \"suporte\", \"problema\", \"erro\", \"bug\", \"solicita\u00e7\u00e3o\", \"ajuda\",\n    \"d\u00favida\", \"sistema\", \"atualiza\u00e7\u00e3o\", \"relat\u00f3rio\", \"urgente\",\n    \"incidente\", \"falha\", \"acesso\", \"login\", \"senha\", \"n\u00e3o funciona\"\n]\n</code></pre>"},{"location":"features/classification/#regras-especiais","title":"Regras Especiais","text":"<ul> <li>Emails com \"reuni\u00e3o\" + \"confirmar\" \u2192 sempre productive</li> <li>Feedback positivo com \"impressionado\" + \"satisfa\u00e7\u00e3o\" \u2192 unproductive</li> </ul>"},{"location":"features/classification/#fluxo-de-classificacao","title":"Fluxo de Classifica\u00e7\u00e3o","text":""},{"location":"features/classification/#niveis-de-confianca","title":"N\u00edveis de Confian\u00e7a","text":""},{"location":"features/classification/#gemini-ai","title":"Gemini AI","text":"<ul> <li>Alta confian\u00e7a: 85-100% - Classifica\u00e7\u00e3o clara</li> <li>M\u00e9dia confian\u00e7a: 70-84% - Classifica\u00e7\u00e3o com alguma incerteza</li> <li>Baixa confian\u00e7a: 50-69% - Classifica\u00e7\u00e3o duvidosa</li> </ul>"},{"location":"features/classification/#sistema-heuristico","title":"Sistema Heur\u00edstico","text":"<ul> <li>Confian\u00e7a fixa: 75% - Baseado em palavras-chave</li> </ul>"},{"location":"features/classification/#contextos-de-email","title":"Contextos de Email","text":"<p>O sistema detecta diferentes contextos para melhor classifica\u00e7\u00e3o:</p>"},{"location":"features/classification/#reunioes","title":"Reuni\u00f5es","text":"<ul> <li>Palavras-chave: \"reuni\u00e3o\", \"agenda\", \"disponibilidade\", \"confirmar\"</li> <li>Sempre classificado como productive</li> </ul>"},{"location":"features/classification/#suporte-tecnico","title":"Suporte T\u00e9cnico","text":"<ul> <li>Palavras-chave: \"suporte\", \"problema\", \"erro\", \"bug\", \"falha\"</li> <li>Sempre classificado como productive</li> </ul>"},{"location":"features/classification/#projetos","title":"Projetos","text":"<ul> <li>Palavras-chave: \"projeto\", \"atualiza\u00e7\u00e3o\", \"status\", \"progresso\"</li> <li>Geralmente classificado como productive</li> </ul>"},{"location":"features/classification/#feedback","title":"Feedback","text":"<ul> <li>Palavras-chave: \"feedback\", \"opini\u00e3o\", \"satisfa\u00e7\u00e3o\", \"experi\u00eancia\"</li> <li>Classifica\u00e7\u00e3o baseada no tom (positivo/negativo)</li> </ul>"},{"location":"features/classification/#estatisticas-de-desempenho","title":"Estat\u00edsticas de Desempenho","text":"<p>O sistema mant\u00e9m estat\u00edsticas de: - Taxa de uso da API Gemini vs Heur\u00edstica - Distribui\u00e7\u00e3o de n\u00edveis de confian\u00e7a - Tempo m\u00e9dio de processamento - Rate limiting e fallbacks</p>"},{"location":"features/file-upload/","title":"Sistema de Upload de Arquivos","text":""},{"location":"features/file-upload/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O sistema permite upload de arquivos PDF e TXT para extra\u00e7\u00e3o autom\u00e1tica de conte\u00fado de emails.</p>"},{"location":"features/file-upload/#formatos-suportados","title":"Formatos Suportados","text":""},{"location":"features/file-upload/#pdf-pdf","title":"PDF (.pdf)","text":"<ul> <li>Processamento via PyPDF2</li> <li>Extra\u00e7\u00e3o de texto de m\u00faltiplas p\u00e1ginas</li> <li>Processamento via AI para estrutura\u00e7\u00e3o</li> </ul>"},{"location":"features/file-upload/#txt-txt","title":"TXT (.txt)","text":"<ul> <li>Leitura direta com encoding UTF-8</li> <li>Fallback para outros encodings</li> <li>Processamento via AI para extra\u00e7\u00e3o de campos</li> </ul>"},{"location":"features/file-upload/#configuracao-de-upload","title":"Configura\u00e7\u00e3o de Upload","text":""},{"location":"features/file-upload/#funcao-get_upload_path","title":"Fun\u00e7\u00e3o <code>get_upload_path</code>","text":"<pre><code>def get_upload_path(instance, filename):\n    \"\"\"Define o caminho para upload de arquivos de email\"\"\"\n    ext = filename.split('.')[-1]\n    subject_slug = slugify(instance.subject[:30])\n    timestamp = datetime.now().strftime(\"%Y%m%d%H%M%S\")\n    return f'uploads/{instance.sender.split(\"@\")[0]}_{subject_slug}_{timestamp}.{ext}'\n</code></pre>"},{"location":"features/file-upload/#estrutura-de-diretorios","title":"Estrutura de Diret\u00f3rios","text":"<pre><code>media/\n\u2514\u2500\u2500 uploads/\n    \u251c\u2500\u2500 user1_meeting-agenda_20231201153045.pdf\n    \u251c\u2500\u2500 user2_support-request_20231201153102.txt\n    \u2514\u2500\u2500 user3_project-update_20231201153150.pdf\n</code></pre>"},{"location":"features/file-upload/#configuracoes-django","title":"Configura\u00e7\u00f5es Django","text":"<pre><code># settings.py\nMEDIA_URL = '/media/'\nMEDIA_ROOT = os.path.join(BASE_DIR, 'media')\n</code></pre>"},{"location":"features/file-upload/#processo-de-extracao","title":"Processo de Extra\u00e7\u00e3o","text":""},{"location":"features/file-upload/#1-upload-e-validacao","title":"1. Upload e Valida\u00e7\u00e3o","text":"<pre><code>def clean(self):\n    if input_method == 'file':\n        if not file:\n            self.add_error('file', 'Por favor, fa\u00e7a upload de um arquivo.')\n\n        # Verificar extens\u00e3o\n        ext = os.path.splitext(file.name)[1].lower()\n        if ext not in ['.txt', '.pdf']:\n            self.add_error('file', 'Apenas arquivos .txt ou .pdf s\u00e3o permitidos.')\n</code></pre>"},{"location":"features/file-upload/#2-extracao-de-texto","title":"2. Extra\u00e7\u00e3o de Texto","text":"<pre><code>def extract_text_from_file(file_path):\n    \"\"\"Extract text from various file types\"\"\"\n    file_extension = os.path.splitext(file_path)[1].lower()\n\n    if file_extension == '.pdf':\n        return extract_from_pdf(file_path)\n    elif file_extension == '.txt':\n        return extract_from_txt(file_path)\n    else:\n        raise ValueError(f\"Unsupported file format: {file_extension}\")\n</code></pre>"},{"location":"features/file-upload/#3-processamento-pdf","title":"3. Processamento PDF","text":"<pre><code>def extract_from_pdf(file_path):\n    \"\"\"Extract text from PDF file\"\"\"\n    try:\n        with open(file_path, 'rb') as file:\n            pdf = PdfReader(file)\n            text = \"\"\n            for page in pdf.pages:\n                text += page.extract_text() + \"\\n\"\n\n        # Usar AI para estrutura\u00e7\u00e3o\n        result = process_document(text, 'pdf')\n\n        return (\n            result.get('subject', 'No Subject'),\n            result.get('content', text),\n            result.get('sender', 'noreply@example.com')\n        )\n    except Exception as e:\n        logger.error(f\"Error extracting PDF: {str(e)}\")\n        return (filename, f\"Failed to process: {str(e)}\", \"noreply@example.com\")\n</code></pre>"},{"location":"features/file-upload/#4-processamento-txt","title":"4. Processamento TXT","text":"<pre><code>def extract_from_txt(file_path):\n    \"\"\"Extract text from text file\"\"\"\n    try:\n        with open(file_path, 'r', encoding='utf-8', errors='ignore') as file:\n            text = file.read()\n\n        # Usar AI para estrutura\u00e7\u00e3o\n        result = process_document(text, 'txt')\n\n        return (\n            result.get('subject', 'No Subject'),\n            result.get('content', text),\n            result.get('sender', 'noreply@example.com')\n        )\n    except Exception as e:\n        logger.error(f\"Error extracting TXT: {str(e)}\")\n        return (filename, f\"Failed to process: {str(e)}\", \"noreply@example.com\")\n</code></pre>"},{"location":"features/file-upload/#processamento-com-ia","title":"Processamento com IA","text":""},{"location":"features/file-upload/#prompt-para-extracao","title":"Prompt para Extra\u00e7\u00e3o","text":"<pre><code>prompt = f\"\"\"\nExtract the following information from this email document:\n1. Email subject line\n2. Email body text\n3. Sender email address\n\nDocument content:\n{file_content}\n\nRespond with only this JSON format:\n{{\n  \"subject\": \"extracted subject\",\n  \"content\": \"extracted content\",\n  \"sender\": \"extracted sender email\"\n}}\n\"\"\"\n</code></pre>"},{"location":"features/file-upload/#fallback-heuristico","title":"Fallback Heur\u00edstico","text":"<pre><code>def _extract_basic_info(text):\n    \"\"\"Basic fallback extraction when AI fails\"\"\"\n    import re\n\n    # Extrair email\n    email_pattern = r'[\\w\\.-]+@[\\w\\.-]+\\.\\w+'\n    email_matches = re.findall(email_pattern, text)\n    sender = email_matches[0] if email_matches else \"noreply@example.com\"\n\n    # Primeira linha como assunto\n    lines = text.strip().split('\\n')\n    subject = lines[0] if lines else \"No Subject\"\n\n    # Resto como conte\u00fado\n    content = '\\n'.join(lines[1:]) if len(lines) &gt; 1 else text\n\n    return {\n        \"subject\": subject[:100],\n        \"content\": content,\n        \"sender\": sender\n    }\n</code></pre>"},{"location":"features/file-upload/#interface-do-usuario","title":"Interface do Usu\u00e1rio","text":""},{"location":"features/file-upload/#formulario-com-opcoes","title":"Formul\u00e1rio com Op\u00e7\u00f5es","text":"<pre><code>&lt;!-- Radio buttons para escolher m\u00e9todo --&gt;\n&lt;input type=\"radio\" name=\"input_method\" value=\"text\" checked&gt; Texto direto\n&lt;input type=\"radio\" name=\"input_method\" value=\"file\"&gt; Upload de arquivo\n\n&lt;!-- Upload de arquivo --&gt;\n&lt;input type=\"file\" name=\"file\" accept=\".txt,.pdf\"&gt;\n\n&lt;!-- Op\u00e7\u00f5es de override --&gt;\n&lt;input type=\"checkbox\" name=\"use_file_subject\" checked&gt;\nUsar campo de assunto acima (ignorar assunto do arquivo)\n\n&lt;input type=\"checkbox\" name=\"use_file_sender\" checked&gt;\nUsar campo de remetente acima (ignorar remetente do arquivo)\n</code></pre>"},{"location":"features/file-upload/#logica-de-processamento","title":"L\u00f3gica de Processamento","text":"<pre><code>if input_method == 'file' and email.file:\n    # Salvar arquivo\n    email.file.save(email.file.name, email.file, save=True)\n\n    # Extrair dados do arquivo\n    subject_from_file, content_from_file, sender_from_file = extract_text_from_file(file_path)\n\n    # Aplicar configura\u00e7\u00f5es do usu\u00e1rio\n    use_manual_subject = form.cleaned_data.get('use_file_subject', False)\n    if not use_manual_subject or not email.subject:\n        email.subject = subject_from_file\n\n    use_manual_sender = form.cleaned_data.get('use_file_sender', False)\n    if not use_manual_sender:\n        email.sender = sender_from_file or extract_email_from_content(content_from_file)\n\n    email.content = content_from_file\n</code></pre>"},{"location":"features/file-upload/#seguranca-e-validacao","title":"Seguran\u00e7a e Valida\u00e7\u00e3o","text":""},{"location":"features/file-upload/#validacoes-implementadas","title":"Valida\u00e7\u00f5es Implementadas","text":"<ul> <li>Extens\u00e3o de arquivo: Apenas .pdf e .txt</li> <li>Tamanho: Limitado pelo Django (default 2.5MB)</li> <li>Encoding: UTF-8 com fallback graceful</li> <li>Path traversal: Prevenido pelo Django FileField</li> </ul>"},{"location":"features/file-upload/#limpeza-de-arquivos","title":"Limpeza de Arquivos","text":"<ul> <li>Naming: Slugify + timestamp para evitar conflitos</li> <li>Storage: Organizado por usu\u00e1rio e data</li> <li>Cleanup: Manual via admin ou comando Django</li> </ul>"},{"location":"features/file-upload/#tratamento-de-erros","title":"Tratamento de Erros","text":"<pre><code>try:\n    # Processar arquivo\n    extracted_data = extract_text_from_file(file_path)\nexcept Exception as e:\n    logger.error(f\"Erro ao processar arquivo: {str(e)}\")\n    return JsonResponse({\n        'status': 'error',\n        'message': f'Erro ao processar o arquivo: {str(e)}'\n    }, status=400)\n</code></pre>"},{"location":"features/job-queue/","title":"Sistema de Filas (Job Queue)","text":""},{"location":"features/job-queue/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O sistema de filas permite processamento ass\u00edncrono de emails, evitando timeouts e melhorando a experi\u00eancia do usu\u00e1rio.</p>"},{"location":"features/job-queue/#componentes","title":"Componentes","text":""},{"location":"features/job-queue/#job-class","title":"Job Class","text":"<p>Representa um job individual na fila.</p>"},{"location":"features/job-queue/#status-possiveis","title":"Status Poss\u00edveis","text":"<ul> <li><code>QUEUED</code>: Na fila, aguardando processamento</li> <li><code>PROCESSING</code>: Em processamento</li> <li><code>COMPLETED</code>: Processado com sucesso</li> <li><code>FAILED</code>: Falhou durante processamento</li> <li><code>EXPIRED</code>: Expirou na fila sem ser processado</li> </ul>"},{"location":"features/job-queue/#atributos","title":"Atributos","text":"<pre><code>class Job:\n    id: str              # UUID \u00fanico\n    job_type: str        # Tipo do job\n    data: Dict           # Dados para processamento\n    status: str          # Status atual\n    result: Any          # Resultado (quando completo)\n    error: str           # Erro (quando falha)\n    created_at: datetime # Timestamp de cria\u00e7\u00e3o\n    started_at: datetime # Timestamp de in\u00edcio\n    completed_at: datetime # Timestamp de conclus\u00e3o\n    callback: Callable   # Fun\u00e7\u00e3o de callback\n    position_in_queue: int # Posi\u00e7\u00e3o na fila\n</code></pre>"},{"location":"features/job-queue/#jobqueue-class-singleton","title":"JobQueue Class (Singleton)","text":"<p>Gerencia a fila de jobs e workers.</p>"},{"location":"features/job-queue/#metodos-principais","title":"M\u00e9todos Principais","text":""},{"location":"features/job-queue/#enqueuejob_type-data-priority-callback","title":"<code>enqueue(job_type, data, priority, callback)</code>","text":"<pre><code>job_id = job_queue.enqueue(\n    job_type=\"process_email_complete\",\n    data={\n        'subject': 'Assunto do email',\n        'content': 'Conte\u00fado do email',\n        'sender': 'user@example.com',\n        'email_id': 123\n    },\n    priority=1,  # 1 = alta prioridade\n    callback=my_callback_function\n)\n</code></pre>"},{"location":"features/job-queue/#get_jobjob_id","title":"<code>get_job(job_id)</code>","text":"<pre><code>job = job_queue.get_job(\"uuid-do-job\")\nif job:\n    print(f\"Status: {job.status}\")\n</code></pre>"},{"location":"features/job-queue/#get_queue_status","title":"<code>get_queue_status()</code>","text":"<pre><code>status = job_queue.get_queue_status()\n# Retorna informa\u00e7\u00f5es sobre fila atual\n</code></pre>"},{"location":"features/job-queue/#tipos-de-jobs","title":"Tipos de Jobs","text":""},{"location":"features/job-queue/#process_email_complete","title":"process_email_complete","text":"<p>Processamento completo de um email (classifica\u00e7\u00e3o + resposta).</p>"},{"location":"features/job-queue/#dados-necessarios","title":"Dados Necess\u00e1rios","text":"<pre><code>{\n    'subject': str,\n    'content': str,\n    'sender': str,\n    'email_id': int  # ID do email no banco\n}\n</code></pre>"},{"location":"features/job-queue/#handler","title":"Handler","text":"<pre><code>def handle_process_email_complete(data):\n    email_data = {\n        'subject': data.get('subject', ''),\n        'content': data.get('content', ''),\n        'sender': data.get('sender', '')\n    }\n    email_id = data.get('email_id')\n    return process_email_and_update(email_data, email_id)\n</code></pre>"},{"location":"features/job-queue/#classify_email","title":"classify_email","text":"<p>Apenas classifica\u00e7\u00e3o de email.</p>"},{"location":"features/job-queue/#dados-necessarios_1","title":"Dados Necess\u00e1rios","text":"<pre><code>{\n    'subject': str,\n    'content': str\n}\n</code></pre>"},{"location":"features/job-queue/#suggest_response","title":"suggest_response","text":"<p>Apenas gera\u00e7\u00e3o de resposta.</p>"},{"location":"features/job-queue/#dados-necessarios_2","title":"Dados Necess\u00e1rios","text":"<pre><code>{\n    'subject': str,\n    'content': str,\n    'category': str\n}\n</code></pre>"},{"location":"features/job-queue/#process_document","title":"process_document","text":"<p>Processamento de documento/arquivo.</p>"},{"location":"features/job-queue/#dados-necessarios_3","title":"Dados Necess\u00e1rios","text":"<pre><code>{\n    'file_content': str,\n    'file_type': str\n}\n</code></pre>"},{"location":"features/job-queue/#sistema-de-prioridades","title":"Sistema de Prioridades","text":"<p>A fila usa <code>PriorityQueue</code> com n\u00edveis de prioridade:</p> <ul> <li>1: Alta prioridade (processamento completo, documentos)</li> <li>2: M\u00e9dia prioridade (gera\u00e7\u00e3o de resposta)</li> <li>3: Baixa prioridade (tarefas de manuten\u00e7\u00e3o)</li> </ul>"},{"location":"features/job-queue/#worker-thread","title":"Worker Thread","text":""},{"location":"features/job-queue/#funcionamento","title":"Funcionamento","text":"<ul> <li>Thread daemon que roda continuamente</li> <li>Processa jobs em ordem de prioridade</li> <li>Trata exce\u00e7\u00f5es e atualiza status</li> <li>Cleanup autom\u00e1tico de jobs antigos</li> </ul>"},{"location":"features/job-queue/#ciclo-de-processamento","title":"Ciclo de Processamento","text":""},{"location":"features/job-queue/#monitoramento","title":"Monitoramento","text":""},{"location":"features/job-queue/#status-da-fila","title":"Status da Fila","text":"<pre><code>status = job_queue.get_queue_status()\n</code></pre>"},{"location":"features/job-queue/#retorna","title":"Retorna","text":"<pre><code>{\n    \"queue_length\": 3,\n    \"active_job\": {\n        \"id\": \"uuid\",\n        \"job_type\": \"process_email_complete\",\n        \"status\": \"processing\"\n    },\n    \"estimated_wait\": 9,  # segundos\n    \"queued_jobs\": [...],  # primeiros 5 jobs\n    \"processing_count\": 1\n}\n</code></pre>"},{"location":"features/job-queue/#status-individual","title":"Status Individual","text":"<pre><code>job = job_queue.get_job(job_id)\njob_dict = job.to_dict()\n</code></pre>"},{"location":"features/job-queue/#retorna_1","title":"Retorna","text":"<pre><code>{\n    \"id\": \"uuid-do-job\",\n    \"job_type\": \"process_email_complete\",\n    \"status\": \"completed\",\n    \"created_at\": \"2023-12-01T10:00:00Z\",\n    \"started_at\": \"2023-12-01T10:00:05Z\",\n    \"completed_at\": \"2023-12-01T10:00:08Z\",\n    \"position_in_queue\": 0,\n    \"estimated_wait_time\": 0,\n    \"processing_time\": 3.0,\n    \"has_result\": true,\n    \"has_error\": false\n}\n</code></pre>"},{"location":"features/job-queue/#configuracoes","title":"Configura\u00e7\u00f5es","text":""},{"location":"features/job-queue/#timeouts","title":"Timeouts","text":"<ul> <li>Job expiration: 1 hora para jobs n\u00e3o processados</li> <li>Cleanup interval: A cada job processado</li> <li>Max age: 1 hora para jobs conclu\u00eddos</li> </ul>"},{"location":"features/job-queue/#thread-management","title":"Thread Management","text":"<ul> <li>Daemon thread: Termina com o processo principal</li> <li>Stop timeout: 5 segundos para parada graceful</li> <li>Error handling: Continue opera\u00e7\u00e3o mesmo com erros</li> </ul>"},{"location":"features/job-queue/#uso-recomendado","title":"Uso Recomendado","text":""},{"location":"features/job-queue/#para-processamento-longo","title":"Para Processamento Longo","text":"<pre><code># Em vez de processamento s\u00edncrono\nresult = process_email(email_data)\n\n# Use processamento ass\u00edncrono\njob_id = queue_complete_email_processing(email_data, email_id)\nreturn {\"job_id\": job_id, \"status\": \"queued\"}\n</code></pre>"},{"location":"features/job-queue/#para-monitoramento","title":"Para Monitoramento","text":"<pre><code># Frontend pode consultar status\njob = job_queue.get_job(job_id)\nif job.status == \"completed\":\n    # Exibir resultado\n    email = Email.objects.get(pk=email_id)\n</code></pre>"},{"location":"features/rate-limiting/","title":"Sistema de Rate Limiting","text":""},{"location":"features/rate-limiting/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O sistema de rate limiting controla o uso de APIs externas para evitar exce\u00e7\u00e3o de limites e custos desnecess\u00e1rios.</p>"},{"location":"features/rate-limiting/#ratelimiter-class","title":"RateLimiter Class","text":""},{"location":"features/rate-limiting/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code>gemini_limiter = RateLimiter(\n    requests_per_minute=20,    # 60 no free tier, usando 20 para folga\n    requests_per_day=15000,    # 60000 no free tier, usando 15000 para folga\n    name=\"gemini\"\n)\n</code></pre>"},{"location":"features/rate-limiting/#funcionamento","title":"Funcionamento","text":""},{"location":"features/rate-limiting/#controles-implementados","title":"Controles Implementados","text":"<ul> <li>Por minuto: M\u00e1ximo de requisi\u00e7\u00f5es em janela deslizante de 60s</li> <li>Por dia: M\u00e1ximo de requisi\u00e7\u00f5es do in\u00edcio ao fim do dia</li> <li>Thread-safe: Uso de <code>threading.RLock()</code></li> </ul>"},{"location":"features/rate-limiting/#estruturas-de-dados","title":"Estruturas de Dados","text":"<pre><code>self.minute_requests = []  # Timestamps das \u00faltimas requisi\u00e7\u00f5es\nself.day_requests = []     # Todas as requisi\u00e7\u00f5es do dia\nself.total_requests_today = 0   # Contador total\nself.day_start = datetime.now().replace(hour=0, minute=0, second=0)\n</code></pre>"},{"location":"features/rate-limiting/#metodos-principais","title":"M\u00e9todos Principais","text":""},{"location":"features/rate-limiting/#can_make_request","title":"<code>can_make_request()</code>","text":"<p>Verifica se uma nova requisi\u00e7\u00e3o pode ser feita.</p>"},{"location":"features/rate-limiting/#retorno","title":"Retorno","text":"<pre><code>can_request, wait_time = limiter.can_make_request()\n# can_request: bool - Se pode fazer requisi\u00e7\u00e3o\n# wait_time: int - Segundos para esperar se n\u00e3o pode\n</code></pre>"},{"location":"features/rate-limiting/#logica","title":"L\u00f3gica","text":"<ol> <li>Remove requisi\u00e7\u00f5es antigas (&gt; 1 minuto)</li> <li>Verifica limite por minuto</li> <li>Verifica limite di\u00e1rio</li> <li>Calcula tempo de espera necess\u00e1rio</li> </ol>"},{"location":"features/rate-limiting/#wait_if_needed","title":"<code>wait_if_needed()</code>","text":"<p>M\u00e9todo principal usado pelo sistema.</p>"},{"location":"features/rate-limiting/#comportamento","title":"Comportamento","text":"<pre><code>can_proceed = limiter.wait_if_needed()\nif can_proceed:\n    # Fazer requisi\u00e7\u00e3o para API\n    result = api_call()\nelse:\n    # Usar fallback ou rejeitar\n    result = fallback_method()\n</code></pre>"},{"location":"features/rate-limiting/#estrategias-de-espera","title":"Estrat\u00e9gias de Espera","text":"<ul> <li>&lt; 5 minutos: Espera o tempo necess\u00e1rio</li> <li>&gt; 5 minutos: Rejeita e usa fallback</li> <li>Novo dia: Reset autom\u00e1tico dos contadores</li> </ul>"},{"location":"features/rate-limiting/#get_stats","title":"<code>get_stats()</code>","text":"<p>Retorna estat\u00edsticas de uso atual.</p>"},{"location":"features/rate-limiting/#retorno_1","title":"Retorno","text":"<pre><code>{\n    \"name\": \"gemini\",\n    \"minute_usage\": 5,\n    \"minute_limit\": 20,\n    \"minute_percent\": 25.0,\n    \"day_usage\": 150,\n    \"day_limit\": 15000,\n    \"day_percent\": 1.0,\n    \"total_today\": 150\n}\n</code></pre>"},{"location":"features/rate-limiting/#integracao-com-ai-service","title":"Integra\u00e7\u00e3o com AI Service","text":""},{"location":"features/rate-limiting/#verificacao-antes-da-chamada","title":"Verifica\u00e7\u00e3o Antes da Chamada","text":"<pre><code>def classify_email(subject, content):\n    if not GEMINI_API_KEY:\n        return _heuristic_classification(subject, content)\n\n    # Verificar rate limiting\n    if not gemini_limiter.wait_if_needed():\n        logger.warning(\"Rate limit excedido, usando classifica\u00e7\u00e3o heur\u00edstica.\")\n        return _heuristic_classification(subject, content)\n\n    # Prosseguir com API Gemini\n    model = genai.GenerativeModel(text_model)\n    response = model.generate_content(prompt)\n\n    # Log de estat\u00edsticas\n    stats = gemini_limiter.get_stats()\n    logger.info(f\"Uso da API: {stats['day_usage']}/{stats['day_limit']} ({stats['day_percent']:.1f}%)\")\n</code></pre>"},{"location":"features/rate-limiting/#logging-e-monitoramento","title":"Logging e Monitoramento","text":"<pre><code># Alerta quando pr\u00f3ximo do limite\nif self.total_requests_today &gt; self.requests_per_day * 0.8:\n    logger.warning(f\"Aproximando-se do limite di\u00e1rio: {self.total_requests_today}/{self.requests_per_day}\")\n\n# Log de cada requisi\u00e7\u00e3o\nlogger.debug(f\"Requisi\u00e7\u00e3o registrada: {self.total_requests_minute}/{self.requests_per_minute} req/min\")\n</code></pre>"},{"location":"features/rate-limiting/#limites-da-api-gemini","title":"Limites da API Gemini","text":""},{"location":"features/rate-limiting/#free-tier-padrao","title":"Free Tier (Padr\u00e3o)","text":"<ul> <li>Por minuto: 60 requisi\u00e7\u00f5es</li> <li>Por dia: 60.000 requisi\u00e7\u00f5es</li> </ul>"},{"location":"features/rate-limiting/#configuracao-conservadora-aplicada","title":"Configura\u00e7\u00e3o Conservadora (Aplicada)","text":"<ul> <li>Por minuto: 20 requisi\u00e7\u00f5es (33% do limite)</li> <li>Por dia: 15.000 requisi\u00e7\u00f5es (25% do limite)</li> </ul>"},{"location":"features/rate-limiting/#sistema-de-fallback","title":"Sistema de Fallback","text":""},{"location":"features/rate-limiting/#quando-rate-limit-e-atingido","title":"Quando Rate Limit \u00e9 Atingido","text":"<ol> <li>Log warning sobre limite atingido</li> <li>Usar classifica\u00e7\u00e3o heur\u00edstica baseada em palavras-chave</li> <li>Manter funcionalidade do sistema</li> <li>Continuar monitoramento para quando limite resetar</li> </ol>"},{"location":"features/rate-limiting/#classificacao-heuristica","title":"Classifica\u00e7\u00e3o Heur\u00edstica","text":"<pre><code>def _heuristic_classification(subject, content):\n    \"\"\"Fallback quando API n\u00e3o dispon\u00edvel\"\"\"\n    text_lower = (subject + \" \" + content).lower()\n\n    # Palavras-chave para cada categoria\n    improdutivo_count = sum(1 for k in improdutivo_keywords if k in text_lower)\n    produtivo_count = sum(1 for k in produtivo_keywords if k in text_lower)\n\n    # Regras especiais\n    if \"reuni\u00e3o\" in text_lower and \"confirmar\" in text_lower:\n        return 'productive'\n\n    # Decis\u00e3o baseada em contagem\n    return 'unproductive' if improdutivo_count &gt; produtivo_count else 'productive'\n</code></pre>"},{"location":"features/rate-limiting/#monitoramento-via-api","title":"Monitoramento via API","text":""},{"location":"features/rate-limiting/#endpoint-apiusage","title":"Endpoint <code>/api/usage/</code>","text":"<p>Retorna estat\u00edsticas em tempo real:</p> <pre><code>{\n  \"gemini_api\": {\n    \"minute_usage\": 5,\n    \"minute_limit\": 20,\n    \"minute_percent\": 25.0,\n    \"day_usage\": 150,\n    \"day_limit\": 15000,\n    \"day_percent\": 1.0,\n    \"total_today\": 150\n  },\n  \"timestamp\": \"2023-12-01T10:30:00Z\"\n}\n</code></pre>"},{"location":"features/rate-limiting/#reset-automatico","title":"Reset Autom\u00e1tico","text":""},{"location":"features/rate-limiting/#diario-meia-noite","title":"Di\u00e1rio (Meia-noite)","text":"<pre><code>def _is_new_day(self):\n    now = datetime.now()\n    if now &gt;= self.day_end:\n        logger.info(\"Novo dia iniciado, resetando contadores\")\n        self.day_requests = []\n        self.reset_day_stats()\n        return True\n    return False\n</code></pre>"},{"location":"features/rate-limiting/#por-minuto-janela-deslizante","title":"Por Minuto (Janela Deslizante)","text":"<pre><code>def _cleanup_old_requests(self):\n    now = time.time()\n    minute_ago = now - 60\n    self.minute_requests = [t for t in self.minute_requests if t &gt; minute_ago]\n</code></pre>"},{"location":"setup/deployment/","title":"Guia de Deployment","text":""},{"location":"setup/deployment/#preparacao-para-producao","title":"Prepara\u00e7\u00e3o para Produ\u00e7\u00e3o","text":""},{"location":"setup/deployment/#1-configuracoes-de-seguranca","title":"1. Configura\u00e7\u00f5es de Seguran\u00e7a","text":""},{"location":"setup/deployment/#settingspy","title":"settings.py","text":"<pre><code># Nunca True em produ\u00e7\u00e3o\nDEBUG = False\n\n# Hosts espec\u00edficos para Railway\nALLOWED_HOSTS = ['*.railway.app', 'domainname.com']\n\n# Chave secreta forte\nSECRET_KEY = os.getenv('SECRET_KEY')  # Do .env\n\n# HTTPS apenas (Railway fornece SSL autom\u00e1tico)\nSECURE_SSL_REDIRECT = True\nSECURE_HSTS_SECONDS = 31536000\nSECURE_HSTS_INCLUDE_SUBDOMAINS = True\nSECURE_HSTS_PRELOAD = True\n</code></pre>"},{"location":"setup/deployment/#variaveis-de-ambiente-para-railway","title":"Vari\u00e1veis de Ambiente para Railway","text":"<pre><code>SECRET_KEY=sua-chave-super-secreta-de-producao\nDEBUG=False\nALLOWED_HOSTS=*.railway.app,domainname.com\nGEMINI_API_KEY=sua-chave-de-producao\nCORS_ORIGIN_FRONT=https://seu-app.railway.app\n</code></pre>"},{"location":"setup/deployment/#2-configuracao-do-banco-de-dados","title":"2. Configura\u00e7\u00e3o do Banco de Dados","text":""},{"location":"setup/deployment/#postgresql-na-railway","title":"PostgreSQL na Railway","text":"<p>A Railway fornece PostgreSQL como add-on. As vari\u00e1veis s\u00e3o injetadas automaticamente:</p> <pre><code># settings.py - Configura\u00e7\u00e3o para Railway\nimport dj_database_url\n\n# Railway injeta DATABASE_URL automaticamente\nDATABASES = {\n    'default': dj_database_url.parse(os.environ.get('DATABASE_URL'))\n}\n</code></pre>"},{"location":"setup/deployment/#dependencias-adicionais","title":"Depend\u00eancias adicionais","text":"<pre><code># Adicionar ao requirements.txt\ndj-database-url&gt;=1.0.0\npsycopg2-binary&gt;=2.9.0\n</code></pre>"},{"location":"setup/deployment/#3-arquivos-estaticos","title":"3. Arquivos Est\u00e1ticos","text":""},{"location":"setup/deployment/#configuracao-para-railway","title":"Configura\u00e7\u00e3o para Railway","text":"<pre><code># settings.py\nSTATIC_URL = '/static/'\nSTATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')\nSTATICFILES_STORAGE = 'whitenoise.storage.CompressedManifestStaticFilesStorage'\n\n# Middleware do WhiteNoise (j\u00e1 configurado)\nMIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'whitenoise.middleware.WhiteNoiseMiddleware',  # Logo ap\u00f3s SecurityMiddleware\n    # ... outros middlewares\n]\n</code></pre>"},{"location":"setup/deployment/#deployment-na-railway","title":"Deployment na Railway","text":""},{"location":"setup/deployment/#1-preparacao-do-projeto","title":"1. Prepara\u00e7\u00e3o do Projeto","text":""},{"location":"setup/deployment/#criar-requirementstxt-atualizado","title":"Criar requirements.txt atualizado","text":"<pre><code># filepath: c:\\Users\\plugify\\Documents\\GitHub\\email_classifier\\server\\requirements.txt\n# ...existing code...\ndj-database-url&gt;=1.0.0\npsycopg2-binary&gt;=2.9.0\n</code></pre>"},{"location":"setup/deployment/#procfile-para-railway","title":"Procfile para Railway","text":"<pre><code># filepath: c:\\Users\\plugify\\Documents\\GitHub\\email_classifier\\Procfile\nweb: cd server &amp;&amp; python manage.py migrate &amp;&amp; python manage.py collectstatic --noinput &amp;&amp; gunicorn email_classifier.wsgi:application --bind 0.0.0.0:$PORT\n</code></pre>"},{"location":"setup/deployment/#railwayjson-opcional","title":"railway.json (Opcional)","text":"<pre><code># filepath: c:\\Users\\plugify\\Documents\\GitHub\\email_classifier\\railway.json\n{\n  \"build\": {\n    \"builder\": \"NIXPACKS\"\n  },\n  \"deploy\": {\n    \"startCommand\": \"cd server &amp;&amp; python manage.py migrate &amp;&amp; python manage.py collectstatic --noinput &amp;&amp; gunicorn email_classifier.wsgi:application --bind 0.0.0.0:$PORT\",\n    \"healthcheckPath\": \"/api/status/\"\n  }\n}\n</code></pre>"},{"location":"setup/deployment/#2-deploy-via-github","title":"2. Deploy via GitHub","text":""},{"location":"setup/deployment/#passo-a-passo","title":"Passo a Passo","text":"<ol> <li> <p>Conectar Repository:    <pre><code># Fazer push do c\u00f3digo para GitHub\ngit add .\ngit commit -m \"Preparar para deploy na Railway\"\ngit push origin main\n</code></pre></p> </li> <li> <p>Acessar Railway Console:</p> </li> <li>V\u00e1 para railway.app</li> <li>Fa\u00e7a login com GitHub</li> <li>Clique em \"New Project\"</li> <li> <p>Selecione \"Deploy from GitHub repo\"</p> </li> <li> <p>Configurar Projeto:</p> </li> <li>Selecione o reposit\u00f3rio <code>email_classifier</code></li> <li> <p>Railway detectar\u00e1 automaticamente que \u00e9 um projeto Python</p> </li> <li> <p>Adicionar PostgreSQL:</p> </li> <li>No dashboard do projeto, clique em \"New\"</li> <li>Selecione \"Database\" \u2192 \"PostgreSQL\"</li> <li>Railway criar\u00e1 automaticamente a vari\u00e1vel <code>DATABASE_URL</code></li> </ol>"},{"location":"setup/deployment/#3-configurar-variaveis-de-ambiente","title":"3. Configurar Vari\u00e1veis de Ambiente","text":"<p>No dashboard da Railway, v\u00e1 em \"Variables\" e adicione:</p> <pre><code># Obrigat\u00f3rias\nSECRET_KEY=sua-chave-secreta-django\nGEMINI_API_KEY=sua-chave-api-gemini\nDEBUG=False\n\n# Opcional (Railway configura automaticamente)\nALLOWED_HOSTS=*.railway.app\nPORT=8000\n</code></pre>"},{"location":"setup/deployment/#4-configuracoes-avancadas","title":"4. Configura\u00e7\u00f5es Avan\u00e7adas","text":""},{"location":"setup/deployment/#custom-domain-opcional","title":"Custom Domain (Opcional)","text":"<pre><code># No dashboard Railway:\n# Settings \u2192 Domains \u2192 Add Custom Domain\n# Adicionar: domainname.com\n</code></pre>"},{"location":"setup/deployment/#health-check","title":"Health Check","text":"<pre><code># O endpoint /api/status/ j\u00e1 serve como health check\n# Railway verificar\u00e1 automaticamente este endpoint\n</code></pre>"},{"location":"setup/deployment/#deployment-via-cli-da-railway","title":"Deployment via CLI da Railway","text":""},{"location":"setup/deployment/#1-instalacao-da-cli","title":"1. Instala\u00e7\u00e3o da CLI","text":"<pre><code># Instalar Railway CLI\nnpm install -g @railway/cli\n\n# Ou via Homebrew (Mac)\nbrew install railway\n\n# Login\nrailway login\n</code></pre>"},{"location":"setup/deployment/#2-deploy-via-cli","title":"2. Deploy via CLI","text":"<pre><code># No diret\u00f3rio do projeto\ncd email_classifier\n\n# Inicializar projeto Railway\nrailway init\n\n# Fazer deploy\nrailway up\n\n# Adicionar PostgreSQL\nrailway add --database postgresql\n\n# Ver logs\nrailway logs\n\n# Abrir no browser\nrailway open\n</code></pre>"},{"location":"setup/deployment/#3-comandos-uteis","title":"3. Comandos \u00dateis","text":"<pre><code># Ver status do deploy\nrailway status\n\n# Executar comandos no servidor\nrailway run python server/manage.py shell\n\n# Ver vari\u00e1veis de ambiente\nrailway variables\n\n# Conectar ao banco de dados\nrailway connect postgresql\n</code></pre>"},{"location":"setup/deployment/#configuracoes-de-producao","title":"Configura\u00e7\u00f5es de Produ\u00e7\u00e3o","text":""},{"location":"setup/deployment/#1-settingspy-para-railway","title":"1. settings.py para Railway","text":"<pre><code># filepath: c:\\Users\\plugify\\Documents\\GitHub\\email_classifier\\server\\email_classifier\\settings.py\n# ...existing code...\n\nimport dj_database_url\n\n# Database configuration for Railway\nif 'DATABASE_URL' in os.environ:\n    DATABASES = {\n        'default': dj_database_url.parse(os.environ.get('DATABASE_URL'))\n    }\nelse:\n    # Fallback para desenvolvimento local\n    DATABASES = {\n        'default': {\n            'ENGINE': 'django.db.backends.sqlite3',\n            'NAME': BASE_DIR / 'db.sqlite3',\n        }\n    }\n\n# Configura\u00e7\u00f5es de seguran\u00e7a para produ\u00e7\u00e3o\nif not DEBUG:\n    SECURE_SSL_REDIRECT = True\n    SECURE_HSTS_SECONDS = 31536000\n    SECURE_HSTS_INCLUDE_SUBDOMAINS = True\n    SECURE_HSTS_PRELOAD = True\n    SECURE_CONTENT_TYPE_NOSNIFF = True\n    SECURE_BROWSER_XSS_FILTER = True\n    SESSION_COOKIE_SECURE = True\n    CSRF_COOKIE_SECURE = True\n\n# CORS configuration para Railway\nCORS_ALLOWED_ORIGINS = [\n    os.getenv('CORS_ORIGIN_FRONT', 'http://localhost:3000'),\n]\n\nif not DEBUG:\n    CORS_ALLOWED_ORIGINS.extend([\n        'https://seu-app.railway.app',\n        'https://domainname.com',\n    ])\n</code></pre>"},{"location":"setup/deployment/#2-logging-para-railway","title":"2. Logging para Railway","text":"<pre><code># Adicionar ao settings.py\nLOGGING = {\n    'version': 1,\n    'disable_existing_loggers': False,\n    'handlers': {\n        'console': {\n            'class': 'logging.StreamHandler',\n        },\n    },\n    'root': {\n        'handlers': ['console'],\n        'level': 'INFO',\n    },\n    'loggers': {\n        'django': {\n            'handlers': ['console'],\n            'level': 'INFO',\n            'propagate': False,\n        },\n        'classifier': {\n            'handlers': ['console'],\n            'level': 'INFO',\n            'propagate': False,\n        },\n    },\n}\n</code></pre>"},{"location":"setup/deployment/#monitoramento-e-manutencao","title":"Monitoramento e Manuten\u00e7\u00e3o","text":""},{"location":"setup/deployment/#1-logs-da-railway","title":"1. Logs da Railway","text":"<pre><code># Ver logs em tempo real\nrailway logs --follow\n\n# Logs de deploy\nrailway logs --deployment\n\n# Filtrar logs por servi\u00e7o\nrailway logs --service web\n</code></pre>"},{"location":"setup/deployment/#2-health-checks","title":"2. Health Checks","text":"<p>A Railway monitora automaticamente o endpoint: <pre><code>https://seu-app.railway.app/api/status/\n</code></pre></p>"},{"location":"setup/deployment/#3-backup-do-banco-de-dados","title":"3. Backup do Banco de Dados","text":"<pre><code># Fazer backup via Railway CLI\nrailway connect postgresql\n# No console do PostgreSQL:\npg_dump -h hostname -U username database_name &gt; backup.sql\n\n# Ou via comando direto\nrailway run pg_dump $DATABASE_URL &gt; backup_$(date +%Y%m%d).sql\n</code></pre>"},{"location":"setup/deployment/#4-scaling-upgrade-de-plano","title":"4. Scaling (Upgrade de Plano)","text":"<pre><code># Ver uso atual de recursos\nrailway metrics\n\n# Configurar autoscaling (planos pagos)\n# No dashboard: Settings \u2192 Autoscaling\n</code></pre>"},{"location":"setup/deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"setup/deployment/#problemas-comuns","title":"Problemas Comuns","text":""},{"location":"setup/deployment/#1-erro-de-build","title":"1. Erro de Build","text":"<pre><code># Ver logs detalhados de build\nrailway logs --deployment\n\n# Rebuild for\u00e7ado\nrailway redeploy\n</code></pre>"},{"location":"setup/deployment/#2-erro-de-database","title":"2. Erro de Database","text":"<pre><code># Verificar conex\u00e3o com banco\nrailway run python server/manage.py dbshell\n\n# Executar migrations manualmente\nrailway run python server/manage.py migrate\n\n# Reset do banco (CUIDADO!)\nrailway run python server/manage.py flush\n</code></pre>"},{"location":"setup/deployment/#3-problemas-de-static-files","title":"3. Problemas de Static Files","text":"<pre><code># Coletar static files manualmente\nrailway run python server/manage.py collectstatic --noinput\n\n# Verificar configura\u00e7\u00e3o do WhiteNoise\nrailway run python server/manage.py check --deploy\n</code></pre>"},{"location":"setup/deployment/#4-problemas-de-memoriaperformance","title":"4. Problemas de Mem\u00f3ria/Performance","text":"<pre><code># Verificar uso de recursos\nrailway metrics\n\n# Otimizar workers do Gunicorn\n# No Procfile, ajustar:\nweb: cd server &amp;&amp; gunicorn email_classifier.wsgi:application --bind 0.0.0.0:$PORT --workers 2 --max-requests 1000\n</code></pre>"},{"location":"setup/deployment/#5-debugging-remoto","title":"5. Debugging Remoto","text":"<pre><code># Acessar shell Django remotamente\nrailway run python server/manage.py shell\n\n# Executar comandos espec\u00edficos\nrailway run python server/manage.py check\nrailway run python server/manage.py showmigrations\n</code></pre>"},{"location":"setup/deployment/#custos-e-limites","title":"Custos e Limites","text":""},{"location":"setup/deployment/#railway-free-tier","title":"Railway Free Tier","text":"<ul> <li>CPU: 500 horas/m\u00eas</li> <li>RAM: 512MB</li> <li>Storage: 1GB</li> <li>Bandwidth: 100GB/m\u00eas</li> <li>Databases: 1 PostgreSQL (500MB)</li> </ul>"},{"location":"setup/deployment/#railway-pro-tier","title":"Railway Pro Tier","text":"<ul> <li>CPU: Ilimitado</li> <li>RAM: Configur\u00e1vel</li> <li>Storage: Configur\u00e1vel</li> <li>Bandwidth: Ilimitado</li> <li>Databases: Ilimitadas</li> </ul>"},{"location":"setup/deployment/#otimizacao-de-custos","title":"Otimiza\u00e7\u00e3o de Custos","text":"<pre><code># Configurar sleep mode para desenvolvimento\n# No dashboard: Settings \u2192 Sleep Mode \u2192 Enable\n\n# Monitorar uso\nrailway metrics --service web\nrailway metrics --service postgresql\n</code></pre>"},{"location":"setup/deployment/#urls-importantes","title":"URLs Importantes","text":"<p>Ap\u00f3s o deploy, sua aplica\u00e7\u00e3o estar\u00e1 dispon\u00edvel em: - App Principal: <code>https://seu-app.railway.app/</code> - API Status: <code>https://seu-app.railway.app/api/status/</code> - Admin: <code>https://seu-app.railway.app/admin/</code> - Documenta\u00e7\u00e3o: <code>https://jonhvmp.github.io/email_classifier/</code></p> <pre><code># Obter URL da aplica\u00e7\u00e3o\nrailway domain\n</code></pre>"},{"location":"setup/environment/","title":"Vari\u00e1veis de Ambiente","text":""},{"location":"setup/environment/#arquivo-env","title":"Arquivo .env","text":"<p>Crie um arquivo <code>.env</code> na raiz do projeto server/ com as seguintes vari\u00e1veis:</p> <pre><code># Django Configuration\nSECRET_KEY=sua-chave-secreta-aqui\nDEBUG=True\nALLOWED_HOSTS=localhost,127.0.0.1\n\n# AI Services\nGEMINI_API_KEY=sua-chave-api-gemini\n\n# CORS Configuration\nCORS_ORIGIN_FRONT=http://localhost:3000\n</code></pre>"},{"location":"setup/environment/#variaveis-obrigatorias","title":"Vari\u00e1veis Obrigat\u00f3rias","text":""},{"location":"setup/environment/#secret_key","title":"SECRET_KEY","text":"<p>Descri\u00e7\u00e3o: Chave secreta do Django para criptografia e seguran\u00e7a. Exemplo: <code>django-insecure-abc123def456...</code> Gera\u00e7\u00e3o: <pre><code>from django.core.management.utils import get_random_secret_key\nprint(get_random_secret_key())\n</code></pre></p>"},{"location":"setup/environment/#gemini_api_key","title":"GEMINI_API_KEY","text":"<p>Descri\u00e7\u00e3o: Chave de API do Google Gemini para classifica\u00e7\u00e3o de emails. Obten\u00e7\u00e3o: 1. Acesse Google AI Studio 2. Crie uma nova API key 3. Configure o projeto e billing se necess\u00e1rio</p> <p>Exemplo: <code>AIzaSyB1234567890abcdef...</code></p>"},{"location":"setup/environment/#variaveis-opcionais","title":"Vari\u00e1veis Opcionais","text":""},{"location":"setup/environment/#debug","title":"DEBUG","text":"<p>Descri\u00e7\u00e3o: Modo de debug do Django. Valores: <code>True</code> ou <code>False</code> Padr\u00e3o: <code>True</code> Produ\u00e7\u00e3o: Sempre <code>False</code></p>"},{"location":"setup/environment/#allowed_hosts","title":"ALLOWED_HOSTS","text":"<p>Descri\u00e7\u00e3o: Hosts permitidos para o Django. Formato: Lista separada por v\u00edrgulas Exemplo: <code>localhost,127.0.0.1,meudominio.com</code> Padr\u00e3o: <code>localhost,127.0.0.1</code></p>"},{"location":"setup/environment/#cors_origin_front","title":"CORS_ORIGIN_FRONT","text":"<p>Descri\u00e7\u00e3o: Origem permitida para requisi\u00e7\u00f5es CORS do frontend. Exemplo: <code>http://localhost:3000</code> Padr\u00e3o: <code>http://localhost:3000</code></p>"},{"location":"setup/environment/#configuracoes-de-apis-legado","title":"Configura\u00e7\u00f5es de APIs (Legado)","text":""},{"location":"setup/environment/#cohere_api_key","title":"COHERE_API_KEY","text":"<p>Descri\u00e7\u00e3o: Chave da API Cohere (n\u00e3o utilizada atualmente). Status: Opcional, mantida para compatibilidade.</p>"},{"location":"setup/environment/#huggingface_api_token","title":"HUGGINGFACE_API_TOKEN","text":"<p>Descri\u00e7\u00e3o: Token da API Hugging Face (n\u00e3o utilizada atualmente). Status: Opcional, mantida para compatibilidade.</p>"},{"location":"setup/environment/#validacao-de-configuracao","title":"Valida\u00e7\u00e3o de Configura\u00e7\u00e3o","text":""},{"location":"setup/environment/#no-codigo","title":"No C\u00f3digo","text":"<pre><code># ai_service.py\nGEMINI_API_KEY = os.getenv('GEMINI_API_KEY')\nlogger.info(f\"GEMINI_API_KEY encontrada: {'Sim' if GEMINI_API_KEY else 'N\u00e3o'}\")\n\nif GEMINI_API_KEY:\n    try:\n        genai.configure(api_key=GEMINI_API_KEY)\n        logger.info(\"API Gemini configurada com sucesso\")\n    except Exception as e:\n        logger.error(f\"Erro ao configurar API Gemini: {str(e)}\")\nelse:\n    logger.warning(\"Chave API do Gemini n\u00e3o encontrada, usando fallback\")\n</code></pre>"},{"location":"setup/environment/#verificacao-via-management-command","title":"Verifica\u00e7\u00e3o via Management Command","text":"<pre><code>python manage.py shell\n</code></pre> <pre><code>import os\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\n# Verificar vari\u00e1veis\nprint(\"SECRET_KEY:\", \"\u2713\" if os.getenv('SECRET_KEY') else \"\u2717\")\nprint(\"GEMINI_API_KEY:\", \"\u2713\" if os.getenv('GEMINI_API_KEY') else \"\u2717\")\nprint(\"DEBUG:\", os.getenv('DEBUG', 'True'))\n</code></pre>"},{"location":"setup/environment/#configuracao-por-ambiente","title":"Configura\u00e7\u00e3o por Ambiente","text":""},{"location":"setup/environment/#desenvolvimento","title":"Desenvolvimento","text":"<pre><code>SECRET_KEY=django-insecure-development-key\nDEBUG=True\nALLOWED_HOSTS=localhost,127.0.0.1\nGEMINI_API_KEY=sua-chave-de-desenvolvimento\nCORS_ORIGIN_FRONT=http://localhost:3000\n</code></pre>"},{"location":"setup/environment/#producao","title":"Produ\u00e7\u00e3o","text":"<pre><code>SECRET_KEY=sua-chave-super-secreta-de-producao\nDEBUG=False\nALLOWED_HOSTS=domainname.com,www.domainname.com\nGEMINI_API_KEY=sua-chave-de-producao\nCORS_ORIGIN_FRONT=https://domainname.com\n</code></pre>"},{"location":"setup/environment/#teste","title":"Teste","text":"<pre><code>SECRET_KEY=test-secret-key\nDEBUG=True\nALLOWED_HOSTS=localhost,127.0.0.1,testserver\n# GEMINI_API_KEY pode ser omitida para usar fallback\nCORS_ORIGIN_FRONT=http://localhost:3000\n</code></pre>"},{"location":"setup/environment/#seguranca","title":"Seguran\u00e7a","text":""},{"location":"setup/environment/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ul> <li>Nunca committar o arquivo <code>.env</code> no git</li> <li>Usar chaves diferentes para dev/prod</li> <li>Rotacionar chaves periodicamente</li> <li>Limitar permiss\u00f5es das APIs</li> </ul>"},{"location":"setup/environment/#gitignore","title":".gitignore","text":"<p>Certifique-se que seu <code>.gitignore</code> inclua: <pre><code># Environment variables\n.env\n.env.local\n.env.production\n</code></pre></p>"},{"location":"setup/environment/#backup-de-chaves","title":"Backup de Chaves","text":"<ul> <li>Mantenha backup seguro das chaves de produ\u00e7\u00e3o</li> <li>Use servi\u00e7os de gerenciamento de secrets em produ\u00e7\u00e3o</li> <li>Documente quais chaves s\u00e3o usadas onde</li> </ul>"},{"location":"setup/installation/","title":"Guia de Instala\u00e7\u00e3o","text":""},{"location":"setup/installation/#pre-requisitos","title":"Pr\u00e9-requisitos","text":""},{"location":"setup/installation/#sistema","title":"Sistema","text":"<ul> <li>Python: 3.8 ou superior</li> <li>pip: Gerenciador de pacotes Python</li> <li>Git: Para clonagem do reposit\u00f3rio</li> </ul>"},{"location":"setup/installation/#apis-externas","title":"APIs Externas","text":"<ul> <li>Google Gemini API: Para classifica\u00e7\u00e3o de emails</li> <li>Conta Google com acesso ao AI Studio</li> </ul>"},{"location":"setup/installation/#instalacao-passo-a-passo","title":"Instala\u00e7\u00e3o Passo a Passo","text":""},{"location":"setup/installation/#1-clonar-o-repositorio","title":"1. Clonar o Reposit\u00f3rio","text":"<pre><code>git clone https://github.com/jonhvmp/email_classifier.git\ncd email_classifier\n</code></pre>"},{"location":"setup/installation/#2-criar-ambiente-virtual","title":"2. Criar Ambiente Virtual","text":"<pre><code># Windows\npython -m venv venv\nvenv\\Scripts\\activate\n\n# Linux/Mac\npython3 -m venv venv\nsource venv/bin/activate\n</code></pre>"},{"location":"setup/installation/#3-instalar-dependencias","title":"3. Instalar Depend\u00eancias","text":"<pre><code>cd server\npip install -r requirements.txt\n</code></pre>"},{"location":"setup/installation/#4-configurar-variaveis-de-ambiente","title":"4. Configurar Vari\u00e1veis de Ambiente","text":"<pre><code># Copiar template\ncp .env.example .env\n\n# Editar com suas configura\u00e7\u00f5es\n# Veja: setup/environment.md\n</code></pre>"},{"location":"setup/installation/#5-configurar-banco-de-dados","title":"5. Configurar Banco de Dados","text":"<pre><code>python manage.py migrate\n</code></pre>"},{"location":"setup/installation/#6-criar-superusuario-opcional","title":"6. Criar Superusu\u00e1rio (Opcional)","text":"<pre><code>python manage.py createsuperuser\n</code></pre>"},{"location":"setup/installation/#7-coletar-arquivos-estaticos","title":"7. Coletar Arquivos Est\u00e1ticos","text":"<pre><code>python manage.py collectstatic --noinput\n</code></pre>"},{"location":"setup/installation/#8-executar-servidor-de-desenvolvimento","title":"8. Executar Servidor de Desenvolvimento","text":"<pre><code>python manage.py runserver\n</code></pre>"},{"location":"setup/installation/#verificacao-da-instalacao","title":"Verifica\u00e7\u00e3o da Instala\u00e7\u00e3o","text":""},{"location":"setup/installation/#1-acessar-interface-web","title":"1. Acessar Interface Web","text":"<p>Abra http://127.0.0.1:8000/ no navegador</p>"},{"location":"setup/installation/#2-testar-api","title":"2. Testar API","text":"<pre><code>curl http://127.0.0.1:8000/api/status/\n</code></pre> <p>Resposta esperada: <pre><code>{\n  \"status\": \"online\",\n  \"message\": \"API est\u00e1 funcionando corretamente\",\n  \"version\": \"1.0.3\"\n}\n</code></pre></p>"},{"location":"setup/installation/#3-testar-classificacao","title":"3. Testar Classifica\u00e7\u00e3o","text":"<ol> <li>Acesse a p\u00e1gina inicial</li> <li>Digite um email de teste</li> <li>Clique em \"Classificar Email\"</li> <li>Verifique se retorna categoria e resposta sugerida</li> </ol>"},{"location":"setup/installation/#solucao-de-problemas","title":"Solu\u00e7\u00e3o de Problemas","text":""},{"location":"setup/installation/#erro-modulenotfounderror","title":"Erro: ModuleNotFoundError","text":"<pre><code># Verificar se o ambiente virtual est\u00e1 ativo\nwhich python\n\n# Reinstalar depend\u00eancias\npip install -r requirements.txt\n</code></pre>"},{"location":"setup/installation/#erro-api-gemini-nao-configurada","title":"Erro: API Gemini n\u00e3o configurada","text":"<pre><code># Verificar vari\u00e1vel de ambiente\npython manage.py shell\n&gt;&gt;&gt; import os\n&gt;&gt;&gt; print(os.getenv('GEMINI_API_KEY'))\n</code></pre>"},{"location":"setup/installation/#erro-csrf-verification-failed","title":"Erro: CSRF verification failed","text":"<ul> <li>Verificar configura\u00e7\u00e3o CORS</li> <li>Adicionar origem em CSRF_TRUSTED_ORIGINS</li> </ul>"},{"location":"setup/installation/#erro-file-upload-nao-funciona","title":"Erro: File upload n\u00e3o funciona","text":"<pre><code># Verificar configura\u00e7\u00e3o de m\u00eddia\npython manage.py shell\n&gt;&gt;&gt; from django.conf import settings\n&gt;&gt;&gt; print(settings.MEDIA_ROOT)\n&gt;&gt;&gt; print(settings.MEDIA_URL)\n</code></pre>"},{"location":"setup/installation/#configuracao-para-desenvolvimento","title":"Configura\u00e7\u00e3o para Desenvolvimento","text":""},{"location":"setup/installation/#debug-mode","title":"Debug Mode","text":"<pre><code># settings.py\nDEBUG = True\nALLOWED_HOSTS = ['localhost', '127.0.0.1']\n</code></pre>"},{"location":"setup/installation/#logging-detalhado","title":"Logging Detalhado","text":"<pre><code>LOGGING = {\n    'version': 1,\n    'disable_existing_loggers': False,\n    'handlers': {\n        'console': {\n            'class': 'logging.StreamHandler',\n        },\n    },\n    'loggers': {\n        'classifier': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': True,\n        },\n    },\n}\n</code></pre>"},{"location":"setup/installation/#hot-reload","title":"Hot Reload","text":"<p>O servidor Django tem hot reload autom\u00e1tico em modo DEBUG.</p>"},{"location":"setup/installation/#executar-testes","title":"Executar Testes","text":""},{"location":"setup/installation/#testes-unitarios","title":"Testes Unit\u00e1rios","text":"<pre><code>python manage.py test\n</code></pre>"},{"location":"setup/installation/#testes-com-coverage","title":"Testes com Coverage","text":"<pre><code>pip install coverage\ncoverage run --source='.' manage.py test\ncoverage report\ncoverage html  # Gera relat\u00f3rio HTML\n</code></pre>"},{"location":"setup/installation/#testes-especificos","title":"Testes Espec\u00edficos","text":"<pre><code># Testar apenas app classifier\npython manage.py test classifier\n\n# Testar apenas views\npython manage.py test classifier.tests.EmailViewTests\n</code></pre>"},{"location":"setup/installation/#comandos-uteis","title":"Comandos \u00dateis","text":""},{"location":"setup/installation/#migrations","title":"Migrations","text":"<pre><code># Criar novas migrations\npython manage.py makemigrations\n\n# Aplicar migrations\npython manage.py migrate\n\n# Ver status das migrations\npython manage.py showmigrations\n</code></pre>"},{"location":"setup/installation/#shell-django","title":"Shell Django","text":"<pre><code># Acessar shell interativo\npython manage.py shell\n\n# Exemplo de uso\n&gt;&gt;&gt; from classifier.models import Email\n&gt;&gt;&gt; Email.objects.count()\n</code></pre>"},{"location":"setup/installation/#limpeza","title":"Limpeza","text":"<pre><code># Limpar banco de dados\npython manage.py flush\n\n# Remover arquivos de migra\u00e7\u00e3o\nfind . -path \"*/migrations/*.py\" -not -name \"__init__.py\" -delete\nfind . -path \"*/migrations/*.pyc\" -delete\n</code></pre>"}]}